(()=>{"use strict";var e,s,t,a,l,r,n={299(e,s,t){var a=t(848),l=t(540),r=t(338),n=t(59),i=t(665),d=t(570),c=t(164),o=t(191);let x=[{name:"Dashboard",href:"/dashboard",icon:o.Uhn},{name:"Nodes",href:"/nodes",icon:o.zDi},{name:"Pools",href:"/pools",icon:o.rrw},{name:"Resources",href:"/resources",icon:o.z5U},{name:"Gateways",href:"/gateways",icon:o.jq$},{name:"HA",href:"/ha",icon:o.ZcI}];function m(){var e;let s=(0,d.zy)();return(0,a.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,a.jsxs)("aside",{className:"w-64 bg-gray-900 text-white flex flex-col",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-800",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(o.rrw,{className:"h-8 w-8 text-primary-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:"SDS Controller"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Software Defined Storage"})]})]})}),(0,a.jsx)("nav",{className:"flex-1 p-4 space-y-1",children:x.map(e=>{let t=s.pathname===e.href;return(0,a.jsxs)(d.N_,{to:e.href,className:(0,c.$)("flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium transition-colors",t?"bg-primary-600 text-white":"text-gray-300 hover:bg-gray-800 hover:text-white"),children:[(0,a.jsx)(e.icon,{className:"h-5 w-5"}),e.name]},e.name)})}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-800 text-xs text-gray-500",children:"v1.3.0"})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,a.jsx)("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:(null==(e=x.find(e=>e.href===s.pathname))?void 0:e.name)??"Dashboard"})}),(0,a.jsx)("main",{className:"flex-1 overflow-auto p-6",children:(0,a.jsx)(d.sv,{})})]})]})}var u=t(454),h=t(467);let g="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://orange1:3375/v1":`${window.location.protocol}//${window.location.hostname}:3375/v1`,p=new class{async request(e,s){let t=`${this.baseUrl}${e}`,a=await fetch(t,{headers:{"Content-Type":"application/json",...null==s?void 0:s.headers},mode:"cors",...s});if(!a.ok)throw Error(`API error: ${a.status} ${a.statusText}`);return a.json()}constructor(e=g){var s=this;(0,h._)(this,"baseUrl",void 0),(0,h._)(this,"getNodes",()=>this.request("/nodes")),(0,h._)(this,"getNode",e=>this.request(`/nodes/${e}`)),(0,h._)(this,"healthCheck",e=>this.request(`/nodes/${e}/health`)),(0,h._)(this,"getPools",()=>this.request("/pools")),(0,h._)(this,"getPool",e=>this.request(`/pools/${e}`)),(0,h._)(this,"createPool",e=>this.request("/pools",{method:"POST",body:JSON.stringify(e)})),(0,h._)(this,"deletePool",e=>this.request(`/pools/${e}`,{method:"DELETE"})),(0,h._)(this,"addDisk",(e,s,t)=>this.request(`/pools/${e}/disks`,{method:"POST",body:JSON.stringify({disk:s,node:t})})),(0,h._)(this,"getResources",()=>this.request("/resources")),(0,h._)(this,"getResource",e=>this.request(`/resources/${e}`)),(0,h._)(this,"createResource",e=>this.request("/resources",{method:"POST",body:JSON.stringify(e)})),(0,h._)(this,"deleteResource",e=>this.request(`/resources/${e}`,{method:"DELETE"})),(0,h._)(this,"setPrimary",function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s.request(`/resources/${e}/primary`,{method:"POST",body:JSON.stringify({node:t,force:a})})}),(0,h._)(this,"getGateways",()=>this.request("/gateways")),(0,h._)(this,"getHaConfigs",()=>this.request("/ha")),this.baseUrl=e}};function j(){let{data:e}=(0,u.I)({queryKey:["nodes"],queryFn:()=>p.getNodes()}),{data:s}=(0,u.I)({queryKey:["pools"],queryFn:()=>p.getPools()}),{data:t}=(0,u.I)({queryKey:["resources"],queryFn:()=>p.getResources()}),{data:l}=(0,u.I)({queryKey:["gateways"],queryFn:()=>p.getGateways()}),r=(null==e?void 0:e.nodes.filter(e=>"online"===e.state).length)??0,n=(null==s?void 0:s.pools.reduce((e,s)=>e+Number(s.totalGb),0))??0,i=(null==s?void 0:s.pools.reduce((e,s)=>e+Number(s.freeGb),0))??0;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)(y,{title:"Nodes",value:`${r}/${(null==e?void 0:e.nodes.length)??0}`,subtitle:"Online nodes",color:"blue",icon:(0,a.jsx)(o.zDi,{className:"h-6 w-6"})}),(0,a.jsx)(y,{title:"Storage",value:`${i}GB`,subtitle:`of ${n}GB free`,color:"green",icon:(0,a.jsx)(o.rrw,{className:"h-6 w-6"})}),(0,a.jsx)(y,{title:"Resources",value:(null==t?void 0:t.resources.length)??0,subtitle:"DRBD resources",color:"purple",icon:(0,a.jsx)(o.z5U,{className:"h-6 w-6"})}),(0,a.jsx)(y,{title:"Gateways",value:(null==l?void 0:l.gateways.length)??0,subtitle:"Active gateways",color:"orange",icon:(0,a.jsx)(o.jq$,{className:"h-6 w-6"})})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Cluster Nodes"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Name"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Address"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Hostname"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"State"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Version"})]})}),(0,a.jsx)("tbody",{children:null==e?void 0:e.nodes.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-4 text-sm",children:e.name}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-gray-500",children:e.address}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-gray-500",children:e.hostname}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:e.state})}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-gray-500",children:e.version})]},e.name))})]})})]})]})}function y(e){let{title:s,value:t,subtitle:l,color:r,icon:n}=e;return(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:s}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:t}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:l})]}),(0,a.jsx)("div",{className:`h-12 w-12 rounded-lg ${{blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",orange:"bg-orange-500"}[r]} flex items-center justify-center text-white`,children:n})]})})}var f=t(419);function b(){let e=(0,i.jE)(),{data:s,isLoading:t}=(0,u.I)({queryKey:["nodes"],queryFn:()=>p.getNodes()}),[r,n]=(0,l.useState)(!1),[d,c]=(0,l.useState)(null),[x,m]=(0,l.useState)(null),[h,g]=(0,l.useState)(!1),[j,y]=(0,l.useState)(null),b=(0,f.n)({mutationFn:e=>p.healthCheck(e),onSuccess:e=>{m(e.health),c(null)},onError:e=>{alert(`Health check failed: ${e.message}`),c(null)}}),q=e=>{c(e),b.mutate(e)},k=e=>{y(e),g(!0)},P=()=>{m(null),c(null)};return t?(0,a.jsx)("div",{className:"text-center py-12",children:"Loading..."}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Storage Nodes"}),(0,a.jsxs)("button",{onClick:()=>n(!0),className:"btn btn-primary flex items-center gap-2",children:[(0,a.jsx)(o.jgn,{className:"h-4 w-4"}),"Register Node"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:null==s?void 0:s.nodes.map(e=>(0,a.jsx)(N,{node:e,onHealthCheck:q,onShowDetails:k,isLoading:b.isPending&&d===e.name},e.name))}),r&&(0,a.jsx)(v,{onClose:()=>n(!1),title:"Register Node",children:(0,a.jsx)(w,{onSuccess:()=>{n(!1),e.invalidateQueries({queryKey:["nodes"]})},onCancel:()=>n(!1)})}),x&&(0,a.jsx)(v,{onClose:P,title:"Health Check Results",children:(0,a.jsx)(S,{health:x,onClose:P})}),h&&j&&(0,a.jsx)(v,{onClose:()=>g(!1),title:"Node Details",children:(0,a.jsx)(C,{node:j,onClose:()=>g(!1)})})]})}function N(e){let{node:s,onHealthCheck:t,onShowDetails:l,isLoading:r}=e,n="online"===s.state;return(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:q("h-10 w-10 rounded-full flex items-center justify-center",n?"bg-green-100":"bg-red-100"),children:(0,a.jsx)(o.zDi,{className:q("h-5 w-5",n?"text-green-600":"text-red-600")})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:s.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:s.hostname})]})]}),(0,a.jsxs)("span",{className:q("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",n?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[n?(0,a.jsx)(o.mU9,{className:"h-3 w-3"}):(0,a.jsx)(o.uDv,{className:"h-3 w-3"}),n?"Online":"Offline"]})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Address"}),(0,a.jsx)("span",{className:"text-gray-900",children:s.address})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Version"}),(0,a.jsx)("span",{className:"text-gray-900",children:s.version})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Last Seen"}),(0,a.jsx)("span",{className:"text-gray-900",children:new Date(1e3*Number(s.lastSeen)).toLocaleString()})]})]}),(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-100 flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>t(s.name),disabled:r||!n,className:q("btn btn-secondary flex-1 text-xs flex items-center justify-center gap-1",(r||!n)&&"opacity-50 cursor-not-allowed"),children:[r?(0,a.jsx)(o.joZ,{className:"h-3 w-3 animate-spin"}):(0,a.jsx)(o.OGi,{className:"h-3 w-3"}),"Health Check"]}),(0,a.jsxs)("button",{onClick:()=>l(s),className:"btn btn-secondary text-xs flex items-center justify-center gap-1",children:[(0,a.jsx)(o.MJW,{className:"h-3 w-3"}),"Details"]})]})]})}function v(e){let{onClose:s,title:t,children:l}=e;return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:t}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(o.m6K,{className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"p-4",children:l})]})})}function w(e){let{onSuccess:s,onCancel:t}=e,[r,n]=(0,l.useState)(""),[i,d]=(0,l.useState)("");return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),alert(`Register node: ${r} at ${i}`),s()},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Node Name"}),(0,a.jsx)("input",{type:"text",value:r,onChange:e=>n(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"e.g., orange1",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Node Address"}),(0,a.jsx)("input",{type:"text",value:i,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"e.g., 192.168.1.100",required:!0})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"btn btn-secondary flex-1",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary flex-1",children:"Register"})]})]})}function S(e){let{health:s,onClose:t}=e,l=[{name:"DRBD",installed:s.drbdInstalled,version:s.drbdVersion},{name:"DRBD Reactor",installed:s.drbdReactorInstalled,version:s.drbdReactorVersion,running:s.drbdReactorRunning},{name:"Resource Agents",installed:s.resourceAgentsInstalled}];return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"space-y-2",children:l.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[e.installed?(0,a.jsx)(o.mU9,{className:"h-5 w-5 text-green-500"}):(0,a.jsx)(o.uDv,{className:"h-5 w-5 text-red-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.name}),e.version&&(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Version: ",e.version]})]})]}),void 0!==e.running&&(0,a.jsx)("span",{className:q("px-2 py-1 rounded text-xs font-medium",e.running?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"),children:e.running?"Running":"Stopped"})]},e.name))}),s.availableAgents&&s.availableAgents.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Available OCF Agents:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:s.availableAgents.map(e=>(0,a.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs",children:e},e))})]}),(0,a.jsx)("button",{onClick:t,className:"btn btn-primary w-full",children:"Close"})]})}function C(e){let{node:s,onClose:t}=e,l=[{label:"Name",value:s.name},{label:"Address",value:s.address},{label:"Hostname",value:s.hostname},{label:"State",value:s.state},{label:"Version",value:s.version},{label:"Last Seen",value:new Date(1e3*Number(s.lastSeen)).toLocaleString()}];return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"space-y-2",children:l.map(e=>(0,a.jsxs)("div",{className:"flex justify-between py-2 border-b border-gray-100",children:[(0,a.jsx)("span",{className:"text-gray-500",children:e.label}),(0,a.jsx)("span",{className:"font-medium",children:e.value})]},e.label))}),(0,a.jsx)("button",{onClick:t,className:"btn btn-primary w-full",children:"Close"})]})}function q(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter(Boolean).join(" ")}function k(){let e=(0,i.jE)(),{data:s,isLoading:t}=(0,u.I)({queryKey:["pools"],queryFn:()=>p.getPools()}),{data:r}=(0,u.I)({queryKey:["nodes"],queryFn:()=>p.getNodes()}),[n,d]=(0,l.useState)(!1),[c,x]=(0,l.useState)(!1),[m,h]=(0,l.useState)(null),g=(0,f.n)({mutationFn:e=>p.createPool(e),onSuccess:()=>{e.invalidateQueries({queryKey:["pools"]}),d(!1)},onError:e=>{alert(`Failed to create pool: ${e.message}`)}}),j=(0,f.n)({mutationFn:e=>p.addDisk(e.pool,e.disk,e.node),onSuccess:()=>{e.invalidateQueries({queryKey:["pools"]}),x(!1),h(null)},onError:e=>{alert(`Failed to add disk: ${e.message}`)}}),y=(0,f.n)({mutationFn:e=>p.deletePool(e.name),onSuccess:()=>{e.invalidateQueries({queryKey:["pools"]})},onError:e=>{alert(`Failed to delete pool: ${e.message}`)}}),b=(null==r?void 0:r.nodes.reduce((e,s)=>(e[s.address]=s.name,e),{}))??{},N=(e,s)=>{h({name:e,node:s}),x(!0)},v=(e,s)=>{confirm(`Are you sure you want to delete pool "${e}"?`)&&y.mutate({name:e,node:s})};if(t)return(0,a.jsx)("div",{className:"text-center py-12",children:"Loading..."});let w=(null==s?void 0:s.pools.reduce((e,s)=>(e[s.node]||(e[s.node]=[]),e[s.node].push(s),e),{}))??{};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Storage Pools"}),(0,a.jsxs)("button",{onClick:()=>d(!0),className:"btn btn-primary flex items-center gap-2",children:[(0,a.jsx)(o.jgn,{className:"h-4 w-4"}),"Create Pool"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:Object.entries(w).map(e=>{let[s,t]=e,l=b[s]||s;return(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:(0,a.jsx)(o.rrw,{className:"h-5 w-5 text-primary-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:l}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[s," • ",t.length," pool",t.length>1?"s":""]})]})]}),(0,a.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,a.jsx)(P,{pool:e,nodeName:l,onAddDisk:N,onDelete:v,isDeleting:y.isPending},`${e.node}-${e.name}`))})]},s)})}),n&&(0,a.jsx)(D,{onClose:()=>d(!1),title:"Create Storage Pool",children:(0,a.jsx)(O,{nodes:(null==r?void 0:r.nodes)??[],isCreating:g.isPending,onSubmit:e=>g.mutate(e),onCancel:()=>d(!1)})}),c&&m&&(0,a.jsx)(D,{onClose:()=>x(!1),title:"Add Disk to Pool",children:(0,a.jsx)($,{poolName:m.name,isAdding:j.isPending,onSubmit:e=>j.mutate({pool:m.name,disk:e,node:m.node}),onCancel:()=>{x(!1),h(null)}})})]})}function P(e){let{pool:s,nodeName:t,onAddDisk:l,onDelete:r,isDeleting:n}=e,i=Number(s.totalGb),d=Number(s.freeGb),c=i>0?(i-d)/i*100:0;return(0,a.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"font-medium text-sm",children:s.name})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:_("text-xs px-2 py-0.5 rounded","zfs"===s.type?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"),children:s.type.toUpperCase()}),(0,a.jsx)("button",{onClick:()=>l(s.name,s.node),className:"text-gray-400 hover:text-primary-600 transition-colors",title:"Add disk",children:(0,a.jsx)(o.dZJ,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>r(s.name,t),disabled:n,className:_("transition-colors",n?"text-gray-300 cursor-not-allowed":"text-gray-400 hover:text-red-600"),title:"Delete pool",children:(0,a.jsx)(o.b6i,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[(0,a.jsxs)("span",{children:[d," GB free"]}),(0,a.jsxs)("span",{children:[i," GB total"]})]}),(0,a.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-primary-500 rounded-full transition-all",style:{width:`${c}%`}})})]})}function D(e){let{onClose:s,title:t,children:l}=e;return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:t}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(o.m6K,{className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"p-4",children:l})]})})}function O(e){let{nodes:s,isCreating:t,onSubmit:r,onCancel:n}=e,[i,d]=(0,l.useState)(""),[c,o]=(0,l.useState)("vg"),[x,m]=(0,l.useState)(""),[u,h]=(0,l.useState)("");return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r({name:i,type:c,node:x,disks:u.split(",").map(e=>e.trim()).filter(e=>e)})},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pool Name"}),(0,a.jsx)("input",{type:"text",value:i,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"e.g., data",required:!0}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:'Will be prefixed with "sds_"'})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pool Type"}),(0,a.jsxs)("select",{value:c,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"vg",children:"LVM VG"}),(0,a.jsx)("option",{value:"zfs",children:"ZFS"}),(0,a.jsx)("option",{value:"thin_pool",children:"LVM Thin Pool"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Node"}),(0,a.jsxs)("select",{value:x,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select a node..."}),s.map(e=>(0,a.jsxs)("option",{value:e.name,children:[e.name," (",e.address,")"]},e.name))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Disks"}),(0,a.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"e.g., /dev/vdb, /dev/vdc",required:!0}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Comma-separated disk paths"})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,a.jsx)("button",{type:"button",onClick:n,disabled:t,className:"btn btn-secondary flex-1",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:t,className:"btn btn-primary flex-1",children:t?"Creating...":"Create"})]})]})}function $(e){let{poolName:s,isAdding:t,onSubmit:r,onCancel:n}=e,[i,d]=(0,l.useState)("");return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r(i)},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pool"}),(0,a.jsx)("input",{type:"text",value:s,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-600"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Disk Path"}),(0,a.jsx)("input",{type:"text",value:i,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"e.g., /dev/vdd",required:!0})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,a.jsx)("button",{type:"button",onClick:n,disabled:t,className:"btn btn-secondary flex-1",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:t,className:"btn btn-primary flex-1",children:t?"Adding...":"Add Disk"})]})]})}function _(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter(Boolean).join(" ")}function A(){let{data:e,isLoading:s}=(0,u.I)({queryKey:["resources"],queryFn:()=>p.getResources()});return s?(0,a.jsx)("div",{className:"text-center py-12",children:"Loading..."}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"DRBD Resources"}),(0,a.jsxs)("button",{className:"btn btn-primary flex items-center gap-2",children:[(0,a.jsx)(o.jgn,{className:"h-4 w-4"}),"Create Resource"]})]}),(0,a.jsxs)("div",{className:"card overflow-hidden",children:[(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 bg-gray-50",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Resource"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Port"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Protocol"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Nodes"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Role"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Volumes"}),(0,a.jsx)("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-500",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:null==e?void 0:e.resources.map(e=>(0,a.jsx)(R,{resource:e},e.name))})]}),!(null==e?void 0:e.resources.length)&&(0,a.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No resources found. Create your first resource to get started."})]})]})}function R(e){let{resource:s}=e;return(0,a.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-8 w-8 rounded bg-purple-100 flex items-center justify-center",children:(0,a.jsx)(o.z5U,{className:"h-4 w-4 text-purple-600"})}),(0,a.jsx)("span",{className:"font-medium",children:s.name})]})}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-gray-500",children:s.port}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700",children:s.protocol})}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-gray-500",children:(0,a.jsx)("div",{className:"flex gap-1",children:s.nodes.map(e=>(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded text-xs",children:e},e))})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("span",{className:function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter(Boolean).join(" ")}("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium","Primary"===s.role&&"bg-green-100 text-green-700","Secondary"===s.role&&"bg-gray-100 text-gray-700","Unknown"===s.role&&"bg-yellow-100 text-yellow-700"),children:s.role})}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-gray-500",children:s.volumes.length}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsxs)("button",{className:"btn btn-secondary text-xs py-1 px-2 flex items-center gap-1",children:[(0,a.jsx)(o.U3x,{className:"h-3 w-3"}),"Status"]}),(0,a.jsxs)("button",{className:"btn btn-secondary text-xs py-1 px-2 flex items-center gap-1",children:[(0,a.jsx)(o.Yvo,{className:"h-3 w-3"}),"Edit"]}),(0,a.jsxs)("button",{className:"btn btn-danger text-xs py-1 px-2 flex items-center gap-1",children:[(0,a.jsx)(o.b6i,{className:"h-3 w-3"}),"Delete"]})]})})]})}function F(){let{data:e,isLoading:s}=(0,u.I)({queryKey:["gateways"],queryFn:()=>p.getGateways()});return s?(0,a.jsx)("div",{className:"text-center py-12",children:"Loading..."}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Storage Gateways"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{className:"btn btn-secondary flex items-center gap-2",children:[(0,a.jsx)(o.jgn,{className:"h-4 w-4"}),"NFS Gateway"]}),(0,a.jsxs)("button",{className:"btn btn-secondary flex items-center gap-2",children:[(0,a.jsx)(o.jgn,{className:"h-4 w-4"}),"iSCSI Gateway"]}),(0,a.jsxs)("button",{className:"btn btn-secondary flex items-center gap-2",children:[(0,a.jsx)(o.jgn,{className:"h-4 w-4"}),"NVMe Gateway"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-md font-semibold mb-3",children:"All Gateways"}),(0,a.jsxs)("div",{className:"card overflow-hidden",children:[(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 bg-gray-50",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Name"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Type"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Resource"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"State"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-500",children:"Node"}),(0,a.jsx)("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-500",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:null==e?void 0:e.gateways.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-8 w-8 rounded bg-orange-100 flex items-center justify-center",children:(0,a.jsx)(o.jq$,{className:"h-4 w-4 text-orange-600"})}),(0,a.jsx)("span",{className:"font-medium",children:e.name})]})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-orange-100 text-orange-700",children:e.type.toUpperCase()})}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-gray-500",children:e.resource}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("span",{className:function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter(Boolean).join(" ")}("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium","running"===e.state?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:e.state||"Unknown"})}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-gray-500",children:e.node||"-"}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsxs)("button",{className:"btn btn-secondary text-xs py-1 px-2 flex items-center gap-1",children:[(0,a.jsx)(o.MJW,{className:"h-3 w-3"}),"Details"]}),(0,a.jsxs)("button",{className:"btn btn-secondary text-xs py-1 px-2 flex items-center gap-1",children:[(0,a.jsx)(o.b6i,{className:"h-3 w-3"}),"Delete"]})]})})]},e.id))})]}),!(null==e?void 0:e.gateways.length)&&(0,a.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No gateways found. Create a gateway to expose your storage."})]})]})]})}function G(){let{data:e,isLoading:s}=(0,u.I)({queryKey:["ha"],queryFn:()=>p.getHaConfigs()}),{data:t}=(0,u.I)({queryKey:["resources"],queryFn:()=>p.getResources()});if(s)return(0,a.jsx)("div",{className:"text-center py-12",children:"Loading..."});let l=new Map((null==t?void 0:t.resources.map(e=>[e.name,e]))??[]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex justify-between items-center",children:(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"HA Configurations"})}),(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:null==e?void 0:e.configs.map(e=>(0,a.jsx)(I,{config:e,resource:l.get(e.resource)},e.resource))}),(!(null==e?void 0:e.configs)||0===e.configs.length)&&(0,a.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No HA configurations found. Create a gateway with HA enabled to get started."})]})}function I(e){let{config:s,resource:t}=e,l=(null==t?void 0:t.role)==="Primary";return(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-12 w-12 rounded-lg bg-primary-100 flex items-center justify-center",children:(0,a.jsx)(o.ZcI,{className:"h-6 w-6 text-primary-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:s.resource}),t&&(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Port: ",t.port," • Protocol: ",t.protocol]})]})]}),(0,a.jsx)("span",{className:function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter(Boolean).join(" ")}("inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium",l?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:l?"Running":"Stopped"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(E,{label:"VIP",value:s.vip}),(0,a.jsx)(E,{label:"Mount Point",value:s.mountPoint}),(0,a.jsx)(E,{label:"Filesystem",value:s.fsType}),(0,a.jsx)(E,{label:"Services",value:s.services.map(e=>(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs mr-1",children:e},e))})]}),(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-100 flex gap-2",children:[(0,a.jsxs)("button",{className:"btn btn-secondary text-xs flex items-center gap-1",children:[(0,a.jsx)(o.MJW,{className:"h-3 w-3"}),"Details"]}),(0,a.jsxs)("button",{className:"btn btn-secondary text-xs flex items-center gap-1",children:[(0,a.jsx)(o.joZ,{className:"h-3 w-3"}),"Check"]}),(0,a.jsxs)("button",{className:"btn btn-warning text-xs flex items-center gap-1",children:[(0,a.jsx)(o.gXi,{className:"h-3 w-3"}),"Evict"]}),(0,a.jsxs)("button",{className:"btn btn-danger text-xs flex items-center gap-1",children:[(0,a.jsx)(o.b6i,{className:"h-3 w-3"}),"Delete"]})]})]})}function E(e){let{label:s,value:t}=e;return(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500",children:s}),(0,a.jsx)("span",{className:"text-gray-900 font-mono text-xs",children:t})]})}let K=new n.E({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:5e3}}}),B=document.getElementById("root");B&&(0,r.createRoot)(B).render((0,a.jsx)(l.StrictMode,{children:(0,a.jsx)(function(){return(0,a.jsx)(i.Ht,{client:K,children:(0,a.jsx)(d.Kd,{children:(0,a.jsx)(d.BV,{children:(0,a.jsxs)(d.qh,{path:"/",element:(0,a.jsx)(m,{}),children:[(0,a.jsx)(d.qh,{index:!0,element:(0,a.jsx)(d.C5,{to:"/dashboard",replace:!0})}),(0,a.jsx)(d.qh,{path:"dashboard",element:(0,a.jsx)(j,{})}),(0,a.jsx)(d.qh,{path:"nodes",element:(0,a.jsx)(b,{})}),(0,a.jsx)(d.qh,{path:"pools",element:(0,a.jsx)(k,{})}),(0,a.jsx)(d.qh,{path:"resources",element:(0,a.jsx)(A,{})}),(0,a.jsx)(d.qh,{path:"gateways",element:(0,a.jsx)(F,{})}),(0,a.jsx)(d.qh,{path:"ha",element:(0,a.jsx)(G,{})})]})})})})},{})}))}},i={};function d(e){var s=i[e];if(void 0!==s)return s.exports;var t=i[e]={exports:{}};return n[e](t,t.exports,d),t.exports}d.m=n,s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,d.t=function(t,a){if(1&a&&(t=this(t)),8&a||"object"==typeof t&&t&&(4&a&&t.__esModule||16&a&&"function"==typeof t.then))return t;var l=Object.create(null);d.r(l);var r={};e=e||[null,s({}),s([]),s(s)];for(var n=2&a&&t;("object"==typeof n||"function"==typeof n)&&!~e.indexOf(n);n=s(n))Object.getOwnPropertyNames(n).forEach(e=>{r[e]=()=>t[e]});return r.default=()=>t,d.d(l,r),l},d.d=(e,s)=>{for(var t in s)d.o(s,t)&&!d.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:s[t]})},d.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),d.r=e=>{"u">typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t=[],d.O=(e,s,a,l)=>{if(s){l=l||0;for(var r=t.length;r>0&&t[r-1][2]>l;r--)t[r]=t[r-1];t[r]=[s,a,l];return}for(var n=1/0,r=0;r<t.length;r++){for(var[s,a,l]=t[r],i=!0,c=0;c<s.length;c++)(!1&l||n>=l)&&Object.keys(d.O).every(e=>d.O[e](s[c]))?s.splice(c--,1):(i=!1,l<n&&(n=l));if(i){t.splice(r--,1);var o=a();void 0!==o&&(e=o)}}return e},a={410:0},d.O.j=e=>0===a[e],l=(e,s)=>{var t,l,[r,n,i]=s,c=0;if(r.some(e=>0!==a[e])){for(t in n)d.o(n,t)&&(d.m[t]=n[t]);if(i)var o=i(d)}for(e&&e(s);c<r.length;c++)l=r[c],d.o(a,l)&&a[l]&&a[l][0](),a[l]=0;return d.O(o)},(r=self.webpackChunk_sds_web_ui=self.webpackChunk_sds_web_ui||[]).forEach(l.bind(null,0)),r.push=l.bind(null,r.push.bind(r));var c=d.O(void 0,["322"],()=>d(299));c=d.O(c)})();